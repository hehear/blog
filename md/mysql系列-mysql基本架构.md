---
title: mysql系列-mysql基本架构
date: 2019-12-03 01:14:27
categories:
  - mysql
tags:
  - mysql
  - 数据库
---

mysql系列-mysql基本架构。
<!-- more -->

------------
### mysql架构


<img class="avatar" src="/img/mysql.jpg">


和其他数据库相比，mysql有点与众不同，它的架构可以在多种不同场景中应用并发挥良好的作用。主要体现在存储引擎的架构上，**插件似的存储引擎架构将查询处理和其他的系统任务以及数据的存储提取相分离**。这种架构可以根据业务的需求和实际需要选择合适的存储引擎。

#### 连接层

最上层是一些客户端和连接服务，包含本地sock通信和大多数基于客户端/服务端工具实现的类似于tcp/ip的通信。主要完成一些类似于连接处理、授权认证、及相关的安全方案。在该层引入了线程池的概念，为通过认证安全接入的客户提供线程。同样在该层上可以实现基于ssl的安全连接。服务器也会为安全接入的每个客户端验证它所具有的操作权限。

#### 服务层

第二层架构主要完成大多数的核心服务功能，如sql接口，并完成缓存的查询，sql的分析和优化部分内置函数的执行，所有跨存储引擎的功能也在这一层实现，如过程、函数等，在这一层，服务器会解析查询并创建相应的内部解析树，并对齐完成相应的优化如确定查询表的顺序，是否利用索引等，最后生成相应的执行顺序操作。如果是select语句，服务器还会查询内部的缓存如果缓存的空间足够大，这样在解决大量读操作的环境中能够很好的提升系统的性能。

#### 引擎层

存储引擎层，存储引擎真正的负责了musql中数据的存储和提取，服务器通过api与存储引擎进行通信。不同的存储引擎具有的功能不同，这样我们可以根据自己的实际需要进行选取。

查看当前引擎命令：
```shell
show variables like '%storage_engine%';
```

MyIsam引擎和InnoDB引擎对比：

|  对比项 | MyIsam  | InnoDB  |
| :------------ | :------------ | :------------ |
| 主外键  | 不支持  |  支持 |
| 事务  | 不支持  |  支持 |
| 行表锁  |  表锁，不适合高并发 |  行锁，适合高并发 |
| 缓存  | 只缓存索引，不缓存真实数据  | 不仅缓存索引还缓存真实数据，对性能要求较高，内存大小对性能起绝对性作用  |
|  表空间 |  小 | 大  |
| 关注点  | 性能  | 事务  |
|  默认安装 | Y  | Y  |



#### 存储层

数据存储层，主要是将数据存储在进行于裸设备的文件系统之上，并完成于存储引擎的交互。