const logger = require('../../common/log4js');
const pool = require('../../common/mysqlPool');

const schoolService={};

/**
 * 新增
 * @param news
 * @param callback
 */
schoolService.add=function(school,callback){
    logger.info('add news :{}',school);
    callback('success');


}

/**
 * 修改
 * @param news
 * @param callback
 */
schoolService.upt=function(school,callback){

}

/**
 * 获取符合条件的数据条数
 * @param news
 * @param callback
 */
schoolService.getTotal=function(school,callback){

}


/**
 * 分页查询数据
 * @param news 条件
 * @param page 分页信息
 * @param callback
 */
schoolService.query4Page=function(school,page,callback){
    pool.query('select * from university WHERE no is null or no=?  limit ?,?',['',(page.pgindex-1)*page.pgsize,page.pgsize], function (err, rows1) {
        if (err) {
            logger.error(err);
            callback('error');
        }else{
            logger.info('load school list:%d 条',rows1.length);
            //callback(rows);
            pool.query('select count(*) as count from university where no is null or no=?  ',[''],function(err, rows){
                if(err){
                    logger.error(err);
                    callback('error');
                }else{
                    page.totalCount=rows[0].count;
                    page.pageCount=page.totalCount%page.pgsize==0?page.totalCount/page.pgsize:parseInt(page.totalCount/page.pgsize)+1;
                    callback(rows1,page);
                }
            });
        }

    });

}

/**
 * 修改数据状态
 * @param id
 * @param st
 * @param callback
 */
schoolService.uptSt=function(id,st,callback){

}


module.exports=schoolService;